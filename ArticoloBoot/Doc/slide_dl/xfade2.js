/*	Image Cross Fade Redux	Version 1.0	Last revision: 02.15.2006	steve@slayeroffice.com	Rewrite of old code found here: http://slayeroffice.com/code/imageCrossFade/index.html*/window.addEventListener?window.addEventListener('load',so_init,false):window.attachEvent('onload',so_init);var d=document, imgs = new Array(), zInterval = null, current=0, pause=false; prevFade=0; succFade=0;function so_init(){	if(!d.getElementById || !d.createElement)return;	css = d.createElement('link');	css.setAttribute('href','slideshow2.css');	css.setAttribute('rel','stylesheet');	css.setAttribute('type','text/css');	d.getElementsByTagName('head')[0].appendChild(css);	imgs = d.getElementById('slideshow').getElementsByTagName('img');	for(i=1;i<imgs.length;i++) imgs[i].xOpacity = 0;	imgs[0].style.display = 'block';	imgs[0].xOpacity = .99;	d.getElementById('bPrev').addEventListener?d.getElementById('bPrev').addEventListener('click',so_xfade_prev,false):d.getElementById('bPrev').attachEvent('onclick',so_xfade_prev);	d.getElementById('bSucc').addEventListener?d.getElementById('bSucc').addEventListener('click',so_xfade_succ,false):d.getElementById('bSucc').attachEvent('onclick',so_xfade_succ);	succFade=setTimeout(so_xfade,10000);}function reset(){	if (prevFade !=0)clearTimeout(prevFade);	if (succFade !=0)clearTimeout(succFade);	nPrec = imgs[current+1]?current+1:0;	nSucc = imgs[current-1]?current-1:imgs.length-1;	imgs[current].xOpacity = 0.99;	imgs[nPrec].xOpacity = -0.01;	imgs[nSucc].xOpacity = -0.01;	setOpacity(imgs[current]);	setOpacity(imgs[nPrec]);	setOpacity(imgs[nSucc]);	imgs[nPrec].style.display = 'none';	imgs[nSucc].style.display = 'none';	imgs[current].style.display = 'block';}	function setOpacity(obj)	{		if(obj.xOpacity>.991)		{			obj.xOpacity = .99;			return;		}		obj.style.opacity = obj.xOpacity;		obj.style.MozOpacity = obj.xOpacity;		obj.style.filter = 'alpha(opacity=' + (obj.xOpacity*100) + ')';	}function so_xfade(){	cOpacity = imgs[current].xOpacity;	nIndex = imgs[current+1]?current+1:0;	nOpacity = imgs[nIndex].xOpacity;	cOpacity-=.10;	nOpacity+=.10;	imgs[nIndex].style.display = 'block';	imgs[current].xOpacity = cOpacity;	imgs[nIndex].xOpacity = nOpacity;	setOpacity(imgs[current]);	setOpacity(imgs[nIndex]);	if(cOpacity<=0)	{		imgs[current].style.display = 'none';		current = nIndex;		succFade= setTimeout(so_xfade,10000);	}	else	{		succFade = setTimeout(so_xfade,30);	}}function so_xfade_succ(){	reset();	succFade = setTimeout(so_xfade,30)}function so_xfade_prev(){	reset();	prevFade = setTimeout(so_xfade_p,30);}function so_xfade_p(){	cOpacity = imgs[current].xOpacity;	nIndex = imgs[current-1]?current-1:imgs.length-1;	nOpacity = imgs[nIndex].xOpacity;	cOpacity-=.10;	nOpacity+=.10;	imgs[nIndex].style.display = 'block';	imgs[current].xOpacity = cOpacity;	imgs[nIndex].xOpacity = nOpacity;	setOpacity(imgs[current]);	setOpacity(imgs[nIndex]);	if(cOpacity<=0)	{		imgs[current].style.display = 'none';		current = nIndex;		if (prevFade!=0) clearTimeout(prevFade);		succFade= setTimeout(so_xfade,10000);	}	else	{		prevFade = setTimeout(so_xfade_p,30);	}}